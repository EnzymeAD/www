


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Calling Convention &mdash; Enzyme Sphinx Theme 0.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/collapsible-lists/css/tree_view.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Troubleshooting and Tips" href="troubleshooting_and_tips.html" />
    <link rel="prev" title="AD of Multi-Source Programs" href="starting/multi_source_ad.html" />
  <!-- Google Analytics -->
  
  <!-- End Google Analytics -->
  

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://enzyme.mit.edu" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://enzyme.mit.edu/get-started">Get Started</a>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Languages
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item" href="https://enzyme.mit.edu/docs/stable/index.html">
                  <span class="dropdown-title">Julia</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="">
                  <span class="dropdown-title">Rust</span>
                  <p></p>
                </a>
            </div>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-arrow">
                Resources
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://enzyme.mit.edu/features">
                  <span class="dropdown-title">About</span>
                  <p>Learn about Enzyme’s features and capabilities</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Community</span>
                  <p>Join the Enzyme developer community to contribute, learn, and get your questions answered.</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Developer Resources</span>
                  <p>Developer documentation, templates and tools </p>
                </a>
                <a class="nav-dropdown-item" href="" target="_blank">
                  <span class="dropdown-title">Forums</span>
                  <p>A place to discuss Enzyme code, issues, install.</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://github.com/EnzymeAD/enzyme">GitHub</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="enzyme-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="enzyme-left-menu" id="enzyme-left-menu">
      <div class="enzyme-side-scroll">
        <div class="enzyme-menu enzyme-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="enzyme-left-menu-search">
            

            
              
              
                <div class="version">
                  0.0.1
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="starting/ad_intro_using_enzyme.html">Introduction to Automatic Differentiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="starting/compiler_based_ad.html">The Stages of Compiler-based Automatic Differentiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="starting/installation.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="starting/multi_source_ad.html">AD of Multi-Source Programs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Language Bindings</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://enzyme.mit.edu/cpp/">C/C++</a></li>
<li class="toctree-l1"><a class="reference external" href="https://enzyme.mit.edu/fortran/">Fortran</a></li>
<li class="toctree-l1"><a class="reference external" href="https://enzyme.mit.edu/julia/">Julia</a></li>
<li class="toctree-l1"><a class="reference external" href="https://enzyme.mit.edu/rust/">Rust</a></li>
<li class="toctree-l1"><a class="reference external" href="https://enzyme.mit.edu/swift/">Swift</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Manual</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Calling Convention</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting_and_tips.html">Troubleshooting and Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Applications and Code Examples of Enzyme</a></li>
<li class="toctree-l1"><a class="reference internal" href="talks_and_tutorials.html">Talks and Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="advanced/advanced_options.html">Advanced options</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced/cuda_guide.html">CUDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced/mpi_guide.html">MPI-Primitives</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced/openmp_guide.html">OpenMP Directives and Constructs</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced/rocm_guide.html">ROCm</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/library_root.html">Library API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="enzyme-container">
      <div class="enzyme-page-level-bar" id="enzyme-page-level-bar">
        <div class="enzyme-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="enzyme-breadcrumbs">
    
      <li>
        <a href="index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Calling Convention</li>
    
    
      <li class="enzyme-breadcrumbs-aside">
        
            
            <a href="_sources/calling_convention.rst.txt" rel="nofollow"><img src="_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="enzyme-shortcuts-wrapper" id="enzyme-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="enzyme-content-wrap" class="enzyme-content-wrap">
        <div class="enzyme-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="enzyme-article" class="enzyme-article">
              
  <section id="calling-convention">
<span id="id1"></span><h1>Calling Convention<a class="headerlink" href="#calling-convention" title="Permalink to this headline">¶</a></h1>
<p>Enzyme is invoked by calling a function <cite>__enzyme_autodiff</cite> with the function being differentiated,
followed by the corresponding primal and shadow arguments. This will result in the original function
being run with the corresponding derivative values being computed.</p>
<section id="function-hooks">
<span id="id2"></span><h2>Function Hooks<a class="headerlink" href="#function-hooks" title="Permalink to this headline">¶</a></h2>
<p>Enzyme replaces all calls to functions that contain the string <code class="docutils literal notranslate"><span class="pre">__enzyme_autodiff</span></code> with a call to the corresponding derivative.
This is done to allow Enzyme to register multiple function signatures.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="w"> </span><span class="n">square</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="kt">float</span><span class="w"> </span><span class="n">__enzyme_autodiffFloat</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">)(</span><span class="kt">float</span><span class="p">),</span><span class="w"> </span><span class="kt">float</span><span class="p">);</span><span class="w"></span>
<span class="kt">double</span><span class="w"> </span><span class="nf">__enzyme_autodiffDouble</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">)(</span><span class="kt">double</span><span class="p">),</span><span class="w"> </span><span class="kt">double</span><span class="p">);</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;float  d/dx %f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">__enzyme_autodiffFloat</span><span class="p">(</span><span class="n">square</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0f</span><span class="p">));</span><span class="w"></span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;double d/dx %f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">__enzyme_autodiffDouble</span><span class="p">(</span><span class="n">square</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>This allows end-library makers to nicely incorporate Enzyme into their workflow through the use
of variadic arguments or templates.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">__enzyme_autodiff</span><span class="p">(...);</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">RT</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">Args</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RT</span><span class="w"> </span><span class="n">__enzyme_autodiff</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Args</span><span class="p">...);</span><span class="w"></span>
</pre></div>
</div>
<p>The first argument should either be a function pointer to the code being differentiated, or
a cast of the function pointer.</p>
</section>
<section id="types">
<span id="id3"></span><h2>Types<a class="headerlink" href="#types" title="Permalink to this headline">¶</a></h2>
<p>Arguments to functions being differentiaed are classified to three types:</p>
<ul class="simple">
<li><p><em>_Inactive arguments_</em> whose values don’t impact the derivative computation. An example of this would be an integer representing the size of an array.</p></li>
<li><p><em>_Output arguments_</em> are active values whose gradient result is passed as a return value. Examples include floats or doubles.</p></li>
<li><p><em>_Duplicated arguments_</em> are active values whose gradient result is stored in a second shadow argument. All active pointer values are duplicated arguments.</p></li>
</ul>
<p>An example program using all three types of these arguments is shown below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span><span class="w"> </span><span class="nf">sumAndMul</span><span class="p">(</span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">mul</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mul</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="p">...</span><span class="w"></span>
<span class="kt">double</span><span class="w"> </span><span class="n">d_mul</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__enzyme_autodiff</span><span class="p">(</span><span class="n">sumAndMul</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="cm">/*duplicated argument*/</span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="n">d_array</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="cm">/*inactive argument*/</span><span class="n">size</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="cm">/*output argument*/</span><span class="n">mul</span><span class="p">);</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
</pre></div>
</div>
<p>Enzyme will automatically attempt to deduce the classification of argument types. Generally, these rules assume that integer types are inactive arguments,
floating-point types are output arguments, and pointer-types are duplicated arguments. A user, however, can explicitly specify the desired classification
by using LLVM metadata.</p>
<p>Inactive arguments are given <code class="docutils literal notranslate"><span class="pre">enzyme_const</span></code> metadata; output arguments are given <code class="docutils literal notranslate"><span class="pre">enzyme_out</span></code> metadata; and duplicated arguments are given <code class="docutils literal notranslate"><span class="pre">enzyme_dup</span></code>.</p>
<div class="highlight-llvm notranslate"><div class="highlight"><pre><span></span><span class="nv">%d_mul</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">tail</span><span class="w"> </span><span class="k">call</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="vg">@__enzyme_autodiff</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">*,</span><span class="w"> </span><span class="kt">i64</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="p">)*</span><span class="w"> </span><span class="vg">@sumAndMul</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">metadata</span><span class="w"> </span><span class="nv">!&quot;enzyme_dup&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="p">*</span><span class="w"> </span><span class="nv">%array</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="p">*</span><span class="w"> </span><span class="nv">%d_array</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">metadata</span><span class="w"> </span><span class="nv">!&quot;enzyme_const&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">i64</span><span class="w"> </span><span class="nv">%size</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">metadata</span><span class="w"> </span><span class="nv">!&quot;enzyme_out&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nv">%mul</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>To ease the process of writing frontends, Enzyme will also consider loads to global values with specific names as a mechanism to specify argument classification.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">enzyme_dup</span><span class="p">;</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">enzyme_out</span><span class="p">;</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">enzyme_const</span><span class="p">;</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">d_mul</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__enzyme_autodiff</span><span class="p">(</span><span class="n">sumAndMul</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="n">enzyme_dup</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="n">d_array</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="n">enzyme_const</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="n">enzyme_out</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">mul</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="shadow-argument-initialization">
<span id="id4"></span><h2>Shadow Argument Initialization<a class="headerlink" href="#shadow-argument-initialization" title="Permalink to this headline">¶</a></h2>
<p>Enzyme assumes that shadow arguments passed in are already initialized and have the same structure as the primal values. Running Enzyme’s generated gradient
will increment the shadow value by the amount of the resultant gradient. As a result, this usually means that you want to zero-initialize the shadow prior
to calling the gradient.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span><span class="w">   </span><span class="n">array</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="kt">double</span><span class="w"> </span><span class="n">d_array</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="n">__enzyme_autodiff</span><span class="p">(</span><span class="n">sumSquare</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="n">enzyme_dup</span><span class="p">,</span><span class="w"> </span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="n">d_array</span><span class="p">);</span><span class="w"></span>

<span class="n">printf</span><span class="p">(</span><span class="s">&quot;d(output)/darray[0] = %f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">d_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="w"></span>
</pre></div>
</div>
<p>For complex datastructures passed as arguments, this requires doing a corresponding initialization of the shadow.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">List</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">List</span><span class="o">*</span><span class="w"> </span><span class="n">next</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">double</span><span class="w"> </span><span class="n">sumList</span><span class="p">(</span><span class="n">List</span><span class="o">*</span><span class="w"> </span><span class="n">next</span><span class="p">);</span><span class="w"></span>
<span class="n">List</span><span class="o">*</span><span class="w"> </span><span class="nf">mklist</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">*</span><span class="w"> </span><span class="n">next</span><span class="p">);</span><span class="w"></span>

<span class="n">List</span><span class="o">*</span><span class="w">   </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span><span class="w"></span>
<span class="n">List</span><span class="o">*</span><span class="w"> </span><span class="n">d_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span><span class="w"></span>

<span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mklist</span><span class="p">(</span><span class="w">  </span><span class="n">i</span><span class="p">,</span><span class="w">   </span><span class="n">list</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">d_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mklist</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">d_list</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">__enzyme_autodiff</span><span class="p">(</span><span class="n">sumList</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">d_list</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="result-only-duplicated-argument">
<span id="id5"></span><h2>Result-only Duplicated Argument<a class="headerlink" href="#result-only-duplicated-argument" title="Permalink to this headline">¶</a></h2>
<p>Enzyme also supports a special version of duplicated argument where users only need the computed gradient of the argument and not
the value computed in the forward pass. For example, consider the function below that computes a loss function. All the user needs
is the gradient of the inputs with respect to the loss and not the loss itself.</p>
<p>We can instead use the value <code class="docutils literal notranslate"><span class="pre">enzyme_dupnoneed</span></code> to specify this property to Enzyme. This allows Enzyme to do additional optimization.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">neuralNet</span><span class="p">(</span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">loss</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">W</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">input</span><span class="p">);</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="p">...</span><span class="w"></span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">loss</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">d_loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">__enzyme_autodiff</span><span class="p">(</span><span class="n">neuralNet</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="n">enzyme_dupnoneed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">loss</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">d_loss</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="n">enzyme_dup</span><span class="p">,</span><span class="w">       </span><span class="n">W</span><span class="p">,</span><span class="w"> </span><span class="n">d_W</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="n">enzyme_dup</span><span class="p">,</span><span class="w">       </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">d_b</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="n">enzyme_const</span><span class="p">,</span><span class="w">     </span><span class="n">input</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="c1">// This value is undefined behavior if using diffe_dupnoneed, otherwise</span>
<span class="w">  </span><span class="c1">// it is the same as it would be from calling neuralNet normally.</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;loss=%f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">loss</span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;d_b[0]=%f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">d_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="wrapper-functions">
<span id="id6"></span><h2>Wrapper Functions<a class="headerlink" href="#wrapper-functions" title="Permalink to this headline">¶</a></h2>
<p>When passing complicated types as arguments, it’s sometimes desirable to explicitly pass them as duplicated argument. This can
be accomplished by creating a wrapper function that takes a pointer argument and simply calls a function with the reference value.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MyClass</span><span class="p">;</span><span class="w"></span>

<span class="n">MyClass</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="n">MyClass</span><span class="o">&amp;</span><span class="p">);</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="n">MyClass</span><span class="o">*</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">MyClass</span><span class="o">*</span><span class="w"> </span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="o">*</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compute</span><span class="p">(</span><span class="o">*</span><span class="n">in</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">MyClass</span><span class="w"> </span><span class="nf">d_compute</span><span class="p">(</span><span class="n">MyClass</span><span class="o">&amp;</span><span class="w"> </span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">MyClass</span><span class="w"> </span><span class="n">d_in</span><span class="p">(</span><span class="mf">0.0</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">MyClass</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">MyClass</span><span class="w"> </span><span class="n">d_out</span><span class="p">(</span><span class="mf">1.0</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">__enzyme_autodiff</span><span class="p">(</span><span class="n">wrapper</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">d_in</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">d_out</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">d_in</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="globals">
<span id="id7"></span><h2>Globals<a class="headerlink" href="#globals" title="Permalink to this headline">¶</a></h2>
<p>All global variables that are active must have their shadow explicitly specified in LLVM. This is done by attaching
metadata that specifies what the shadow of that global is.</p>
<div class="highlight-llvm notranslate"><div class="highlight"><pre><span></span><span class="vg">@global</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">external</span><span class="w"> </span><span class="k">local_unnamed_addr</span><span class="w"> </span><span class="k">global</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="k">align</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nv">!enzyme_shadow</span><span class="w"> </span><span class="p">!{</span><span class="kt">double</span><span class="p">*</span><span class="w"> </span><span class="vg">@dglobal</span><span class="p">}</span><span class="w"></span>
<span class="vg">@dglobal</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">external</span><span class="w"> </span><span class="k">local_unnamed_addr</span><span class="w"> </span><span class="k">global</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="k">align</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="custom-gradients">
<span id="id8"></span><h2>Custom Gradients<a class="headerlink" href="#custom-gradients" title="Permalink to this headline">¶</a></h2>
<p>Functions can be given a custom gradient by attaching two pieces of metadata. These pieces of metadata specify an
augmented forward pass that saves any state necessary for the reverse pass and the reverse pass that computes the gradient.</p>
<p>Presently, custom gradients are only supported where Enzyme’s default argument classification is correct. This
means that the all floating-point arguments must be treated as active output arguments, all pointer arguments
must be treated as active duplicated arguments, and all integers are inactive arguments.</p>
<p>Both functions have the same arguments the forward pass along with any duplicated arguments mixed in. The gradient
function then has a differential return value if the original function’s return value is an output argument. The
final argument is a custom “tape” type that can be used to pass information from the forward to the reverse pass.</p>
<p>The return type of the augmented forward pass is a struct type containing first the tape type, followed by the
original return type, if any. If the return type is a duplicated type, then there is a third argument which
contains the shadow of the return.</p>
<p>The return type of the reverse pass is a struct containing derivatives of all of the output arguments.</p>
<div class="highlight-llvm notranslate"><div class="highlight"><pre><span></span><span class="k">define</span><span class="w"> </span><span class="k">internal</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="vg">@augment_add2</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="nv">%x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="nl">entry:</span><span class="w"></span>
<span class="w">  </span><span class="nv">%add</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">fadd</span><span class="w"> </span><span class="k">fast</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nv">%x</span><span class="p">,</span><span class="w"> </span><span class="m">2.000000e+00</span><span class="w"></span>
<span class="w">  </span><span class="nv">%struct1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">insertvalue</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">undef</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nv">%add</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="w"></span>
<span class="w">  </span><span class="k">ret</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="nv">%struct1</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">define</span><span class="w"> </span><span class="k">internal</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="vg">@gradient_add2</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="nv">%x</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nv">%differet</span><span class="p">,</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="nv">%tapeArg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="nl">entry:</span><span class="w"></span>
<span class="w">  </span><span class="nv">%struct1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">insertvalue</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">undef</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nv">%differet</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="w"></span>
<span class="w">  </span><span class="k">ret</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="nv">%struct1</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">declare</span><span class="w"> </span><span class="nv">!enzyme_augment</span><span class="w"> </span><span class="p">!{{</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">)*</span><span class="w"> </span><span class="vg">@augment_add2</span><span class="p">}</span><span class="w"> </span><span class="nv">!enzyme_gradient</span><span class="w"> </span><span class="p">!{{</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="p">{})*</span><span class="w"> </span><span class="vg">@gradient_add2</span><span class="p">}</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="vg">@add2</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="nv">%x</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="troubleshooting_and_tips.html" class="btn btn-neutral float-right" title="Troubleshooting and Tips" accesskey="n" rel="next">Next <img src="_static/images/chevron-right-blue.svg" class="next-page"></a>
      
      
        <a href="starting/multi_source_ad.html" class="btn btn-neutral" title="AD of Multi-Source Programs" accesskey="p" rel="prev"><img src="_static/images/chevron-right-blue.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright Enzyme.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/EnzymeAD/enzyme_sphinx_theme">theme</a> provided by <a href="https://enzyme.mit.edu">Enzyme</a>.
      </div>
      <br>
     

</footer>

          </div>
        </div>

        <div class="enzyme-content-right" id="enzyme-content-right">
          <div class="enzyme-right-menu" id="enzyme-right-menu">
            <div class="enzyme-side-scroll" id="enzyme-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Calling Convention</a><ul>
<li><a class="reference internal" href="#function-hooks">Function Hooks</a></li>
<li><a class="reference internal" href="#types">Types</a></li>
<li><a class="reference internal" href="#shadow-argument-initialization">Shadow Argument Initialization</a></li>
<li><a class="reference internal" href="#result-only-duplicated-argument">Result-only Duplicated Argument</a></li>
<li><a class="reference internal" href="#wrapper-functions">Wrapper Functions</a></li>
<li><a class="reference internal" href="#globals">Globals</a></li>
<li><a class="reference internal" href="#custom-gradients">Custom Gradients</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
         <script src="_static/jquery.js"></script>
         <script src="_static/underscore.js"></script>
         <script src="_static/doctools.js"></script>
         <script src="_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
         <script src="_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <footer class="site-footer" id="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://enzyme.mit.edu" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://enzyme.mit.edu">Enzyme</a></li>
            <li><a href="https://enzyme.mit.edu/get-started">Get Started</a></li>
            <li><a href="https://enzyme.mit.edu/features">Features</a></li>
            <li><a href="https://github.com/EnzymeAD/enzyme/blob/master/CONTRIBUTING.md">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="">Resources</a></li>
            <li><a href="https://enzyme.mit.edu/tutorials">Tutorials</a></li>
            <li><a href="https://enzyme.mit.edu/docs/stable/index.html">Docs</a></li>
            <li><a href="" target="_blank">Discuss</a></li>
            <li><a href="https://github.com/EnzymeAD/enzyme/issues" target="_blank">Github Issues</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <ul>
            <li class="list-title">Stay Connected</li>
            <li>
              <div id="mc_embed_signup">
                <form
                  action="https://groups.google.com/d/forum/enzyme-dev"
                  method="post"
                  id="mc-embedded-subscribe-form"
                  name="mc-embedded-subscribe-form"
                  class="email-subscribe-form validate"
                  target="_blank"
                  novalidate>
                  <div id="mc_embed_signup_scroll" class="email-subscribe-form-fields-wrapper">
                    <div class="mc-field-group">
                      <label for="mce-EMAIL" style="display:none;">Email Address</label>
                      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
                    </div>

                    <div id="mce-responses" class="clear">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->

                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" value=""></div>

                    <div class="clear">
                      <input type="submit" value="" name="subscribe" id="mc-embedded-subscribe" class="button email-subscribe-button">
                    </div>
                  </div>
                </form>
              </div>

            </li>
          </ul>
        </div>
      </div>
    </div>
  </footer>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://enzyme.mit.edu" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://enzyme.mit.edu/get-started">Get Started</a>
          </li>

          <li>
            <a href="">Ecosystem</a>
          </li>

          <li>
            <a href="">Mobile</a>
          </li>

          <li>
            <a href="">PyTorch Hub</a>
          </li>

          <li>
            <a href="">Blog</a>
          </li>

          <li>
            <a href="https://enzyme.mit.edu/tutorials">Tutorials</a>
          </li>

          <li class="resources-mobile-menu-title">
            Docs
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://enzyme.mit.edu/docs/stable/index.html">PyTorch</a>
            </li>

            <li>
              <a href="">torchaudio</a>
            </li>

            <li>
              <a href="">torchtext</a>
            </li>

            <li>
              <a href="">torchvision</a>
            </li>

            <li>
              <a href="">TorchElastic</a>
            </li>

            <li>
              <a href="">TorchServe</a>
            </li>

            <li>
              <a href="">PyTorch on XLA Devices</a>
            </li>
          </ul>

          <li class="resources-mobile-menu-title">
            Resources
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="">Developer Resources</a>
            </li>

            <li>
              <a href="https://enzyme.mit.edu/features">About</a>
            </li>

            <li>
              <a href="">Models (Beta)</a>
            </li>

            <li>
              <a href="">Community</a>
            </li>

            <li>
              <a href="">Forums</a>
            </li>
          </ul>

          <li>
            <a href="https://github.com/EnzymeAD/enzyme">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      enzymeAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.enzyme-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>